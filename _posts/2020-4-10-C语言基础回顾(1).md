---
layout:     post   				    
title:    C语言基础回顾(1)				 
subtitle:  C语言基础回顾(1)     #副标题
date:       2020-4-10			   	# 时间
author:     Lauk				# 作者
header-img: img/post-bg-2015.jpg 	#这篇文章标题背景图片
catalog: true 						# 是否归档
tags:								#标签
    - C
---

### 一.输出与输入

#### 1.输出函数

```c
#include <stdio.h> // 文件包含,之所以能使用 printf,跟这行代码有关
int main(){	//主函数部分,整个程序的入口位置
	printf("hello my friend"); //打印函数
	return 0; // 不是重点
}
```

printf 函数就是所谓的 "输出函数，可以尝试在printf函数的双引号中间换一些其他内容,但要注意的是,printf后面的括号和双引号**必须实在英文输入法环境下的**。这是规则

```
printf("Hi,my frined:\n\tthis is the first day I know you");
```

#### 2.类型与变量

![1586491195191]( https://static001.geekbang.org/resource/image/84/b3/8400db71ab5a307ea0a5c4b14f9b8db3.jpg )

```c
#include <stdio.h>

int main(){
	int a = 167, b = 543;
	printf("%d + %d = %d\n", a, b, a + b);
	return 0;
}
```

1. "%d + %d = %d\n",叫做格式控制字符串,其中%d 是整型的"格式占位符"
2. a, b, a + b 叫做参数列表,每一项一次对应一个"格式占位符"要输出的内容

 “格式占位符”与参数列表中的项一一对应，按照顺序，第一个 %d 与 a 对应，第二个 %d 与 b 对应，第三个 %d 与 a+b 对应。在输出内容时，会被替换成为对应项的内容。输出结果如下 167 + 543 = 710

 你会看到，相应的 %d 被按顺序替换成了变量 a、变量 b 以及表达式 a + b 的内容。 

![1586493298122]( https://static001.geekbang.org/resource/image/8b/7f/8b14b84efaa6ef6a1bfb9ea6c33ef57f.jpg )

在上表中，金拱门有多少家，是一个整数，因为不可能出现0.5这样的半家，所以在计算机中表示未int的整数类型;巨人的身高则有零有整，所以在计算机中表示为float 或 double的浮点数类型；而一个人的名字就不能用数字类型来表示了，而是采用字符串类型来存储

![]( https://static001.geekbang.org/resource/image/50/c5/500329dcf91c14904bd318db91e18ec5.jpg )

#### 3.输入函数

```c
#include <stdio.h>
int main(){
	int a, b; //定义变量a,b
	scanf("%d%d",&a, &b); //输入函数
	printf("%d + %d = %d", a, b, a + b); //输出函数
	return 0;
}
```

scanf 函数 "变量是用来存放数据的",计算机会把数据存储在a、b两个变量中  注意：a、b 两个变量前面有一个特殊的符号 &（取地址符）

- printf 函数的返回值,代表向屏幕上打印了多少个字符
- scanf 函数的返回值,代表成功给多少个变量赋了值

#### 4.思考题

> 思考题(1):位数输出
>
>  计算一个输入整数的十进制表示的位数？ 
>
>  条件 1：允许有多余输出的情况下，怎么实现？ 
>
>  条件 2：只允许输出数字位数的时候，又该怎么实现？ 
>
>  请单纯考虑使用 printf 一族函数方法实现。 

>  思考题（2）：读入一行字符串 
>
>  自行实现一个读入一行字符串，并且输出相关内容的程序
>
>  条件 1：如果字符串中没有空格，怎么实现？ 
>
>  条件 2：如果字符串中有空格，又该怎么实现？ 
>
>  请单纯考虑用 scanf 一族函数方法实现。 

#### 5.输出函数显示颜色

 在我讲输出函数的时候，提到转义字符，其中有一个转义字符就是用来操作颜色的，它就是：\033。下面就让我们具体看一下，它是如何工作的。  设置颜色，以 \033 开始，也以 \033 结束，这种首尾呼应的结构对记忆比较友好。具体格式如下： 

```
 格式：\033[属性代码{; 属性代码...}m 输出内容\033[0m 
```

属性代码:

-  0 代表关闭所有属性 
-  1 代表高亮 / 粗体 
-  4 代表下划线 
-  33 代表黄色 

```c
#include <stdio.h>
int main(){
	printf("\033[1;4;33mhello color\033[0m");
	return 0;
}

```

 运行以后，你就会在终端看到一行高亮且带有下划线的“hello color”字符串。如下图所示： 

![]( https://static001.geekbang.org/resource/image/d7/26/d7116bf318af80c5d1900e07b89bf726.jpg )

#### 6.课程小结

1.  printf 函数是用来输出内容的方法，包含了格式控制字符串和参数列表两部分。 
2.  类型和变量是两个完全不同的概念，变量是用来存储数据的。 
3.  使用格式占位符的时候，需要对应到相关类型，整型对应到 %d，字符型对应到 %c，浮点型对应到 %f，双精度浮点型对应到 %lf。 

### 二.判断与循环

#### 1.逻辑分支判断的分支结构

代码添加判断能力: "if...else"语法结构 我们先来看"if...else" 语法结构

```c
if (条件表达式) 一条语句1;
else 一条语句 2 
```

 简单来说，if 和 else 都是关键字，代表分支逻辑中的 “如果”和 “否则”。if 后面跟着的括号里面，需要放一个条件表达式，条件表达式如果成立，程序会执行 “语句 1”，否则就会执行 “语句 2”。下面我来举个例子，你就明白了： 

```c
#include <stdio.h>
int main(){
	int a, b;
	scanf("%d%d",&a, &b);
	if(a == b) printf("a is equal to b!\n");
	else printf("a is not equal to b!\n");
	return 0;
}
```

 这段程序中，首先定义了两个变量 a 和 b，然后通过输入函数（scanf）给变量 a、b 赋值。之后就是重点部分了，根据我们上面所说的，如果 if 后面的条件表达式成立，那么就会输出 “a is equal to b!\n”， 否则就会输出 “a is not equal to b!\n”。 

 上面的程序中，你会看到程序中的 if 后面跟着一个括号，括号里面放着一个表达式，这个就是我们所谓的条件表达式，而这个括号，是必不可少的。我们发现，这个条件表达式用 两个等号 连接 a 和 b，作用是判断 a 和 b 里面存储的值是否相等。可千万别跟赋值表达式的一个等号弄混了 

 说到这里，我要告诉你一个重要的事实，变量有变量对应的值，表达式也有表达式对应的值。那么例如上面代码中的条件表达式“a == b”所对应的值是什么呢？其实就是数字 1 或者 0，分别表示“条件成立”（a 与 b 的值相等）和“不成立”（a 与 b 的值不相等）。 

##### 延伸内容

 那么除了条件判等以外，还有哪些条件运算符呢？有判断不等于的“a != b”，大于的 “a > b”，小于的 “a < b”，大于等于的 “a >= b”，小于等于的 “a <= b”，逻辑非 “!(a > b)”，等价于 “a <= b”。同时多个条件表达式，还可以用逻辑 && 和 || 进行连接。 

 事实上，if 的括号里面，不仅可以放条件表达式，类似于 “a - b”这种的表达式，也是可以当做 if 的条件的。 

 当一般表达式作为条件的时候，if 是怎么执行的呢？很简单，记住： 表达式的值，非 0 即为真。例如，下面两行代码，效果等价： 

```c
if (a != b) printf("a is not equal to b!\n");
if (a - b) printf("a is not equal to b!\n");
```

 你会看到，第二行代码中，用 “a - b”代替 “a != b”，取得了同样的程序运行效果。因此，你只需要重点思考，表达式 “a - b” 什么时候结果非 0 即可，是不是当且仅当 “a != b”时，“a - b”的结果非 0，根据之前所说的非 0 即为真，那么 if 条件也就算是成立了。 

" if 后面跟一条语句 " ”这个概念，其实指的是 if 后面的条件成立时所执行的代码。这里，我们的重点是要理解一条语句都包含什么形式，大致可以分为如下几类。 

**第一种** 空语句 ，就是什么都没有，单纯以一个分号结尾，例如下面这行代码，即使条件成立，也不会有任何实质上的操作。 

```c
if (a == 3);
```

**第二种,单一语句** ，比空语句多了语句内容，以分号结尾，例如下面这行代码，当条件成立的时候，会输出 “hello geek!”。 

```c
if (a == 3 ) printf("hello geek!\n");
```

**第三种,复合语句** 被大括号包裹，中间是若干条语句

```c
if (a == 3){
	printf("hello geek1!\n");
	printf("hello geek2!\n");
	printf("hello geek3!\n");
}
```

 当条件成立以后，程序会依次执行大括号里面的三条语句： 

**第四种,结构语句** ，以 if，for，while 等开头的分支语句或循环语句，例如下面这段代码，首先会先判断 a==3，如果条件成立，才会执行下面第二条 if 分支语句，当第二条 if 分支语句的条件也成立的时候，才会输出 “hello geek!”。 

```c
if (a == 3)
	if (b == 4){
		printf("hello geek!\n");
}
```

#### 2.for和while循环语句

 我们先来看语法结构较简单的 while 语句： 

```c
while (循环条件) 一条语句;
```

 以 while 关键字开头，后面跟着循环条件，也就是一个条件表达式，然后是一条语句。while 循环，顾名思义，当循环条件成立时，就会执行一次后面的语句，之后就是再判断循环语句是否成立，如果成立就再执行，一直到循环条件不成立为止。 

利用 while 循环，输出前 100 个正整数： 

```c
int i = 0;
while (i++ < 100) printf( "%d\n",i)
```

 上面代码中，我们是用 i++ 表达式的值和 100 进行比较，表达式的值会遍历 0 到 99 所有的值，由于 printf 在 i++ 之后输出 i 的值，所以实际上每次输出的都是 i + 1 之后的值，也就是说 printf 会输出 1～100 所有值。具体的你可以参考下面的这个程序流程图。 

![]( https://static001.geekbang.org/resource/image/a3/f4/a37e05821040b86c2226ac60b95dacf4.jpg )

for 语句得结构:

```c
for  (初始化①; 循环条件②; 循环后操作③) 一条语句④;
```

 如果要是用 for 循环输出 1～100 所有值，会显得代码更清晰一些： 

```c
for (int i = 1; i <= 100; i++) printf("%d\n", i);
```

#### 3.思考题

(1)打印乘法表

>  使用循环和条件判断，打印一个格式优美的 66 乘法表 
>
>  要求 1：输出内容及样式参照下面给出的样例 
>
>  要求 2：每两列之间用 \t 字符进行分隔，行尾无多余 \t 字符 

```c
#include <stdio.h>
int main()
{
 int i, j, n;
 for (i = 1; i <= 6; i++)
 {
  for (j = 1; j <= i; j++)
   printf("%d*%d=%2d  ", j, i, i * j);
  printf("\n");
 }
 return 0;
}
```

#### 4.课程小结

1.  熟练掌握分支和循环结构的执行顺序
2.  if 语句，首先判断条件表达式的真假，如果为真，则执行 if 里面的语句。 
3.  for 循环，分成四部分，其中②④③部分，构成了一个循环，第①部分是用做初始化的。 
4.  所谓一条语句的概念，包括了空语句，单一语句，复合语句和结构语句。 

###  三.随机函数

#### 1.真随机与伪随机

 所谓真随机其实并不难理解，我们以掷骰子为例，掷出 1～6 点的概率均为 1/6，如果我问你，上一次掷出的点数是 4，那么下一次掷出 6 点的概率是多大？你会发现，依然是 1/6，我们称这两次掷骰子的事件是相互独立的，上一次的结果和下一次之间没有必然联系。 

![]( https://static001.geekbang.org/resource/image/a8/9f/a8e3c9f39a4cd913891d10f35f6f369f.jpg )

 通过上面这个示意图，你就很容易看出，所谓真随机，就是我们通常意义下的随机。那么什么又是伪随机呢？从名字上面来看，伪随机，带个伪字，说明本质上不是随机，可看起来是随机。 

![]( https://static001.geekbang.org/resource/image/f4/7a/f44e2aafc5cfd8e4b0f8d50434d5b17a.jpg )

 所谓计算机中的伪随机数序列就是类似第二个序列那样的，没有什么明显规律的一个规模更大的循环序列。  

#### 2.程序中的随机函数

 现在我们所接触到的语言中，没有真随机，全是伪随机。也就是说，语言中给我们准备好了一个随机函数，这个随机函数会根据上一个随机值和一个固定的计算规则,得到下一个随机值。

随机种子这个概念，设置随机种子就是在设置随机函数中记录的上一个随机值。例如，上面我们自己做出来的 6 个长度的伪随机序列，如果随机种子设置为值 1，我们得到的值依次是 635421，如果设置为值 3，那么我们将依次得到 542163。 

```c
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
int main()
{
 printf("%d\n", rand() % 1000); // 永远输出固定值
 srand(time(0));
 printf("%d\n", rand() % 1000); // 每次运行都不同
 return 0;
}
```

 上面代码中，我们用 rand() 函数，获得一个随机值，这个就是我们前面讲的随机函数，它将依次的返回随机序列中的每一个值。 

 而 srand() 函数就是设置随机种子的函数，也就是设置随机函数上一次的状态值。time(0) 将返回一个时间戳，你就可以把他当成和当前时间相关的一个整型数字。 

 会发现，上面这段程序中，在第 6 行代码里，我们虽然使用了 rand() 函数，可每次运行都将输出同样的值，这是因为我们没有设置随机种子，每次运行时 rand() 函数所记录的起始值都相同，所以每次运行输出的随机值也都相同。 

 而第 8 行代码中，由于我们根据程序运行时的当前时间设置了随机种子，每次运行程序，第 8 行都将输出不同的值。事实上，如果你在 srand() 函数里面设置一个固定值，每次运行程序，结果也都将是一样的，这个你可以自行尝试。 

#### 3.思考题

>  思考题：设计迷你随机函数 
>
>  设计一个循环过程，循环 100 次，以不太明显的规律输出 1～100 中的每个数字。 
>
>  要求 1：规律尽量不明显。 
>
>  要求 2：只能使用循环和最基本的运算，不允许超前使用数组。 

#### 4.用有趣的方法计算 n 值

我们来思考一下哈，首先我们需要有一个循环，循环每一次，让计算机帮我们做一次实验。每次实验呢，让计算机模拟随机选择点的这个过程，然后我们需要判断一下随机选择的点，是否在圆内部；如果在，我们就记录一次。最后用落在圆里的次数比上总实验次数再乘以 4，就得到了 π 的近似值。

 这个过程中，你到现在还比较懵的，可能就是随机选点的过程了。那就跟我来看下面代码吧： 

```c
double x = 1.0 * rand() /RAND_MAX;
```

 上述代码中的 rand() 随机函数，返回值的范围是 [0, RAND_MAX]，通过上述表达式计算，我们就得到了一个 [0.0, 1.0] 之间的随机值了。 

```c
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
int main()
{
 int n = 0, m = 0;
 for (int i = 0; i < 1000000; i++)
 {
  double x = 1.0 * rand();
  double y = 1.0 * rand();
  if (x * x + y * y <= 1.0)
   m += 1;
  n += 1;
 }
 printf("%lf\n", 4.0 * m / n);
 return 0;
}
```

 上述代码中，我让计算机重复 10 万次实验，每次在坐标轴的第一象限中的 1 * 1 的区域中随机选择一个点，变量 m 记录的是落在圆内部的次数，变量 n 记录的是总实验次数。运行这个程序，在我的环境中，输出的是 3.142096，你可以试一下在你的环境中的运行结果，以及加大实验次数以后，对结果的影响。 

#### 5.课程小结

1.  计算机中都是伪随机函数，也就是说，下一次的随机值，跟本次的随机值是相关的。 
2.  使用 srand 函数设置随机种子，也就是设置伪随机过程中的第一个起始点的位置。 

### 四.数组

#### 1.数组:规模化存储工具

利用数组，我们可以定义存放一组数据的存储区用法如下代码所示： 

```c
int arr[1000];
```

 通过上述代码，我们很轻松的就定义了存储 1000 个整型变量的存储区 arr。这里相当于向计算机申请了可以存储 1000 个整型变量的存储空间。第一个存储整型数据的内存空间，也就是第一个整型变量，就是 arr[0]，第二个整型变量是 arr[1]，以此类推。arr 后面方括号里面的东西，我们称之为“数组下标”，数组下标从 0 开始，也就是说，代表 1000 个整型变量的数组，下标范围应该是 0 到 999

![]( https://static001.geekbang.org/resource/image/dd/a3/dd48cf83f2e2a3510c50a72b9368bca3.jpg )





 有了数组以后，你就可以轻松的完成读入 n 个整型数据的任务了，参考代码如下： 

```c
int n, arr[1000];
scanf("%d",&n);
for(int i = 0;i < n; i++) scanf("%d",&arr[i]);
```

 代码中，第一行定义了一个整型变量 n 和一个最多存储 1000 个整型元素的数组空间。第二行接下来读入 n 的值，第三行利用循环结构循环 n 次，循环变量 i 取值从 0 到 n-1，循环每次读入一个整型数据存放在 arr[i] 里面。 

 这样一段程序执行完后，n 个整型数据就被依次的存放在了 arr[0] 到 arr[n-1]中。当你想在程序中使用第三个整型数据的时候，只需要访问 arr[2] 即可。当然，上述循环变量的取值范围也可以调整到 1 到 n，这样做的话，相当于我们将 n 个整型数据存放在了 arr[1]到 arr[n] 处。 

#### 2.字节与地址: 数据的住所和门牌号

 什么是字节呢？它是计算机中最基本的存储单位，就像一个一个不可分割的小格子一样，存在于我们计算机的内存中。例如，我们通常所说的，一个 32 位整型元素占用 4 个字节，那就意味着这个元素需要占用 4 个小格子，不会存在某个元素占用 0.5 个小格子的情况。这就是所谓的不可分割。 

![]( https://static001.geekbang.org/resource/image/d7/9a/d7a4f1a553a70e730749f4af790e559a.jpg )

 任何类型的元素，整型也好，浮点型也罢，只要是想存储在计算机中，就一定要放在这些小格子里面，唯一的区别，就是每一种类型的元素占用的格子数量不一样。例如：32 位整型占 4 个格子，double 双精度浮点型占 8 个格子。在这里，需要注意的是，每一种基础类型，在内存中存储时，一定是占用若干个连续的存储单元。 

 那么如何查看某个类型的元素究竟占用多大的存储空间呢？可以使用 sizeof 这个运算符，如下： 

```c
int a;
sizeof(a); //计算 a 变量中占用字节数量
sizeof(int); // 计算一个整型元素占用字节数量
```

 正如你所看到的，sizeof 的使用，就像函数方法一样，我们想要查看什么元素或者类型所占用字节数量，就把什么传入 sizeof 即可，你可以使用 printf 语句输出 sizeof 表达式的值以查看结果。 

 了解了什么是字节以后，下面我们就要说一个更小的单位了，叫做比特，英文是 bit。这个是计算机中表示数据的最小单位。对比字节是存储数据的最基本单位，比特是表示信息的最基本单位。 

 那什么又是比特呢？在其他参考资料上你可能知道，计算机里面的所有数据，均是用二进制来表示以及存储的，这里需要注意，是所有的。那么一个比特，就是一个二进制位，要么是 0，要么是 1。8 比特位是 1 个字节，那么我们之前所说的 32 位整型，也就是占 32 个比特位的整数类型，换算一下，正好是占 4 个字节。 

 说完了字节的概念后，我们再来说说地址。  现在我们的一些小区里面都有一个集中式的邮箱，邮递员来投递信件的时候，只需要把信件放到相应的邮箱里面即可。而作为住户，会有一把能打开自己家邮箱的钥匙，找到自己的邮箱，取出信件即可。  如果把这个场景放在计算机中，住户其实就是 CPU，而邮箱就是内存。你会发现，住户之所以可以准确找到自己的邮箱，是因为每个邮箱上面有一个独立编号。那么 CPU 能够准确找到程序所需要数据的本质原因，也是因为每一个字节都有一个独立的编号，我们管这个编号，叫做：内存地址！下面我给你放了一张示意图： 

![]( https://static001.geekbang.org/resource/image/ef/64/ef6ef4330f86c45d5c18202d06edf364.jpg )

比特是数据表示的最小单位，就是我们通常所说的一个二进制位。字节是数据存储的最基本单位，存储在计算机中的数据，一定是占用若干个字节的存储空间。最后就是内存地址，是每一个字节的唯一标记。 

#### 3.内存地址

不同数据类型，用不同的格式占位符输出，例如：%d 对应了十进制整型的输出。内存地址则采用 %p 这个格式占位符进行输出，下面给你一个演示程序，你可以在你的环境中运行一下： 

```c
#include<stdio.h>
int main(){
	int a;
	printf("%p\n",&a); //输出 a 变量的地址
	return 0;
}
```

 代码中，首先定义一个了整型变量 a，然后使用 %p 占位符输出 a 变量的地址。单一的 & 运算符放到变量前面，取到的就是这个变量的首地址 为什么说是首地址呢？上一部分说了，一个 32 位整型变量会占用 4 个字节的存储空间，每一个字节都会有一个地址，那么你会发现，上面程序中的 a 变量实际上有 4 个地址，这 4 个地址究竟哪一个作为 a 变量的地址呢？答案是最靠前的那个地址，作为 a 变量的地址，也就是这个变量的首地址。 

![]( https://static001.geekbang.org/resource/image/83/10/8367f7c6d3405494a19b5c4289e4f710.jpg )

 看到了变量的地址信息以后，下面就让我们来看一看与数组相关的地址信息，看下面这段程序： 

```c
#include<stdio.h>
int main(){
	int arr[100];
	printf("&arr[0] = %p\n,&arr[0]");
	printf("&arr[1] = %p\n,&arr[1]");
	printf("    arr = %p\n",arr);
	return 0;
}
```

 上述代码，会输出三行信息，针对这三行信息，每个人的程序运行出来的结果很可能是不一样的，这一点没关系，可你一定会发现如下规律：第一个地址与第二个地址之间差 4 字节，而输出的第三个地址与第一个地址完全相同。 

-  第一，数组的每个元素之间在内存中是连续存储的，也就是对上面程序中的数组而言，第一个元素占头 4 个字节，第二个元素紧接着占接下来的 4 个字节的存储空间。再结合上面说到的变量首地址的概念，你就很容易理解为什么头两个地址之间差 4 了。 
-  第二，在程序中，当我们单独使用数组名字的时候，实际上就代表了整个数组的首地址，整个数组（arr[100]）的首地址就是数组中第一个元素的首地址，也就是 arr[0] 的地址。 

 在这里，我们来进一步看一下这个等价关系，arr 等价于 &arr[0]（取地址 arr[0]），实际上我们的地址也是支持 +/- 法的，也就是 arr + 0 等价于 arr[0] 的地址，那么 arr[1] 的地址等于 arr 加几呢？ 

你可能会认为是加 4，这种直觉还是值得鼓励的，可结果不正确，这个和地址的类型有关系，后面讲到指针的时候，我再详细的讲给你听。不过，事实上，arr + 1 就等价于 arr[1] 的地址，更一般的 arr + i 就等价于 arr[i] 的地址。关于地址上的 +/- 运算的规则，我在后续的文章中会详细进行讲解。

#### 4.scanf 函数

 有了上面对于地址的基本认识以后，我们再来回顾一下 scanf 函数的用法，你可能会有新的收获，看如下读入程序： 

```c
#include<stdio.h>
int main(){
	int a;
	scanf("%d",&a);
	return 0;
}
```

 上面这个程序，就是一个最简单的读入程序，首先定义一个整型变量 a，然后读入一个整数,存储到a中

 为什么要把 a 变量的地址传递给 scanf 函数呢？这个很好理解，你就把 scanf 函数当成邮递员，邮递员得到了信件以后，需要知道这个数据放到哪个邮箱里面啊，而你需要做的就是把邮箱地址告诉这个邮递员即可，就是变量 a 的地址，这样 scanf 函数就能把获得的数据，准确的放到 a 变量所对应的内存单元中了。 

#### 5.思考题

> 去掉倍数
>
>  设计一个去掉倍数的程序，要求如下： 
>
>  首先读入两个数字 n 和 m，n 的大小不会超过 10，m 的大小都不会超过 10000； 
>
>  接下来读入 n 个各不相同的正整数，输出 1 到 m 中，有哪些数字无法被这 n 个正整数中任意的一个整除。 

> 用数组，做递推 
>
> 有了对数组的基本认识之后，就让我们来看一下今天的任务应该如何求解。请你观察下面的位运算性质： 

```c#
y =  x & (x - 1)
```

  按位与以后的结果再赋值给 y 变量，下面我们着重来讨论 y 变量与 x 变量之间的关系。 

既然是位运算，我们就需要从二进制的角度来思考这个问题。首先思考 x - 1 的二进制表示与 x 二进制表示之间的关系，当 x 二进制表示的最后一位是 1 的时候，x - 1 就相当于将 x 最后的一位 1 变成了 0，如果 x 二进制表示最后一位是 0 呢，计算 x - 1 的时候，就会试图向前借位，应该是找到最近的一位不为 0 的位置，将这一位变成 0，原先后面的 0 都变成 1，如下图所示： 

![]( https://static001.geekbang.org/resource/image/f2/96/f253de915071b2dcf400b5c2bb87d096.jpg )

 图中打 * 的部分，代表了 x 与 x - 1 二进制表示中完全相同的部分。根据按位与操作的规则，相应位置都为 1，结果位就为 1，那么 x 与上 x - 1 实际效果等效于去掉 x 二进制表示中的最后一位 1，从而我们发现原来 y 变量与 x 变量在二进制表示中，只差一个 1。 

 回到原任务，如果我们用一个数组 f 记录相应数字二进制表示中 1 的数量，那么 f[i] 就代表 i 这个数字二进制表示中 1 的数量，从而我们可以推导得到 f[i] = f[i & (i - 1)] + 1，也就是说 i 比 i & (i - 1) 这个数字的二进制表示中的 1 的数量要多一个，这样我们通过一步计算就得到 f[i] 的结果。 

```c
#include <stdio.h>
int f[1001];
int main()
{
  int n, i;
  scanf("%d", &n);
  f[0] = 0;
  for (i = 1; i <= n; i++)
  {
    f[i] = f[i & (i - 1)] + 1;
  }
  for (i = 1; i <= n; i++)
  {
    if (i != 1)
      printf(" ");
    printf("%d", f[i]);
  }
  printf("\n");
  return 0;
}
```

 这个程序中，首先先读入一个整数 n，代表要求解的范围，然后循环 n 次，每一次通过递推公式 f[i] = f[i & (i - 1)] + 1 计算得到 f[i] 的值，最后输出 1 到 n 中每个数字二进制表示中 1 的个数。 

#### 6.课程小结

1.   使用数组，可以很方便的定义出一组变量存储空间，数组下标从 0 开始。 
2.  数据的最基本存储单位是字节，每一个字节都有一个独一无二的地址。 
3.  一个变量占用若干个字节，第一个字节的地址，是这个变量的首地址，称为：变量地址。 

### 三.字符串

`printf("%.2lf",3.1415926);`

 %lf 是 double 双精度浮点型输出的格式占位符，当我们想要保留小数点后两位的时候，只需要在 % 和 lf 中间加上 .2 即可，2 写在 .(点) 的后面代表小数点后 2 位。 

#### 1.值和变量

 所谓整型变量，就是存储整型的变量。这么解释呢，好像又啥都没说，可这句话本来就带有不说自明的效果。根据名字理解，就是可以变化的量，就像我在代码中定义了一个整型变量 a，然后通过读入给 a 赋值，我问你，a 等于多少，你只能回答不知道，因为这个 a 变量的值是可以变化的。 

 看完了变量这个概念以后，那什么又是“值”呢，也很简单，就是存储在变量中的内容，就是值。整型变量存储整型值，浮点型变量存储浮点型值。比如说，数字 3 就是整型值，如果我们为了后续计算想存储这个整型值，就需要放到一个整型变量中。 

![]( https://static001.geekbang.org/resource/image/b3/28/b3b9f7c50459f54386c0ec08bc1e7428.jpg )

#### 2.字符串和字符数组

 “字符串”就是“值”，而“字符数组”就是存储字符串数据的空间，类比于“变量”的概念。如果说 1、2、3、4、5 这种整型“值”，你可能很容易理解，因为在你之前的学习中就接触过。那么什么是字符串值呢? 先看一下字符串值的形式： 

![]( https://static001.geekbang.org/resource/image/16/ca/160d3bd153ce0022754f14a04393aaca.jpg )

 如上图所示，是一个 “hello world” 内容的字符串数据，字符串数据被一对双引号包裹，中间是字符串内容。像我们看到的上面字符串内容中的 h 啊，e 啊，l 啊，这些就是所谓的“字符”，那么多个字符写成一串，故名“字符串”。为了加以区分，字符内容是用单引号，字符串内容是用双引号。 

 之前我们学过，一个字符占一个字节的空间，那么这个 “hello world” 字符串内容占多少个存储空间呢？hello 有五个字符，world 有五个字符，是 10 个字符么？不对。别忘了中间还有一个空格字符呢，虽然不可见，可你看得出来它对内容的影响。 

 那么加在一起一共是 11 个字符么？也不对，这个字符串数据中，还有一个彻底看不见影响，可对于底层来说很重要的字符，我们管它称作“杠零字符”，写作 \0。每次读这个，都让我想起健身房里面的杠铃

![]( https://static001.geekbang.org/resource/image/2a/df/2a0f2862b86dd81eb65fe7893157f5df.jpg )

 你可以看到，“hello world” 字符串中的每一个字符会占用一个字节存储单元，结尾还有一个 \0 字符，这个 \0 字符是标记字符串结束的。也就是，我们的程序在看到这个字符串的时候，会从第一个字符开始，直到碰到 \0 字符为止，这中间的内容就是字符串的内容。 

 这里我们要强调两个概念“字符串长度”和“字符串占用空间”，这是两个相似但不同的概念。字符串长度，就是字符串内容所占字节数量，例如示意图中“hello world”这个字符串内容，长度是 11。 

 而如果要说这个字符串所占用的空间大小，那就别忘了，还有一个 \0 字符需要额外占用 1 位呢。所以如果说到“字符串占用空间”是多少的话，应该是 12，它要比“字符串长度”多 1，多出来的这个 1，就是用来存放 \0 字符的。 

 看完了字符串的基本概念以后，字符数组的概念就容易理解得多了，就是用来存放字符串的变量空间。从名字上面看的话，字符数组本质上是个数组，但这个数组的每一个元素类型不再是我们之前说到的整数类型，而是变成了字符型，也就是之前所提到的 char 类型。 

```
char str[12] = "hello world";
printf("%s", str);
```

 就如上面这段代码所示，定义了一个长度为 12 的字符数组，然后将字符串 “hello world” 存储到这个空间中。注意，这种给字符数组赋值的方法，只能出现在字符数组定义时这样使用，非定义语句中，不能这样给字符数组赋值，会得到一个编译器给的错误提示。然后在第 2 行代码中，我们通过 printf 函数，输出字符数组中的信息，其中 %s 是字符串数据的格式占位符。最终你会在你的电脑上得到一行 hello world 的输出。 

#### 3.字符串操作的利器

两个更加灵活且强大的字符串操作函数： sscanf函数和sprintf函数 从名字上面来看，除了名称前面加了一个 s 以外，剩下的部分，就是 scanf 和 printf，前面这个 s 其实指代的是 string，也就是字符串。正常来说，与 scanf 和 printf 进行信息交互的场所就是你运行 C 语言程序时候所看到的那个黑色框框，而与 sscanf 和 sprintf 进行信息交互的场所则是字符数组。

```c
 char str[20] = "123.45";
 double num;
 sscanf(str, "%lf", &num);
```

 在这个例子中，第 1 行是一个字符数组 str，其中的字符串信息是 “123.45”，第 2 行定义了一个浮点型的变量，第 3 行代码是重点，它使用 sscanf 从 str 所存储的字符串中读入一个浮点型数据，然后赋值给 num 变量，这里比传统的 scanf 函数多了一个参数，这个参数代表读取数据的字符串信息。  如何将一个字符串转换成一个浮点型数据 ，即把原始字符串的“123.45”转换成了浮点型数据“123.45”。那么你也可以自行设想将字符串转换成整型数据等等。其实 sscanf 就是提供了一种将字符串信息转换成其他信息的方式。  

```c
char str[100];
sprintf(str,"hello world");
printf("%s",str);
```

 例子代码中分成 3 行，第 1 行定义了一个字符数组 str，第 2 行调用 sprintf 函数，相比于 printf 函数，多了第一项的参数，代表将原本输出到标准输出流中的内容，输出到 str 数组中。所谓标准输出流是一种专业的叫法，现在你可以简单的认为，就是你所认识的那个黑框框。 

sscanf 函数与 sprintf 函数对比着看的话，如果说 sscanf 是将字符串转换成整型、浮点型等其他类型的方法，那么 sprintf 就是将其他类型转换成字符串类型的方法。

#### 4.思考题

 **思考题（1）：体验利器** 

介绍了 sprintf 和 sscanf 两个字符串处理的利器工具，那么就请使用 sprintf 函数实现 strlen、strcpy、strcat 函数的功能，注意哦，只允许使用 sprintf 函数，模仿如上三个函数的功能。 

 **思考题（2）：优美的遍历技巧** 

 介绍完了字符串的相关知识以后，请思考如下问题，如何在不计算字符串长度的情况下，遍历字符串的每一位呢？ 

 程序设计要求是，读入一个字符串，然后在不计算字符串长度的情况下，输出字符串中的每一个字符，每个字符占一行。其中所谓计算字符串长度的方法，包括但不限于 strlen，sprintf，先行 for 循环遍历统计等。 

 **实现保留任意小数** 

 最后，让我们回到今天的任务，实现保留任意位小数输出的功能。请你注意观察，printf 函数的第一个参数，究竟是个什么？你会恍然大悟，printf 函数的第一个参数不就是个字符串，既然是字符串信息，那我只需要在 printf 语言前，拼接合适的字符串信息传给 printf 函数即可。  例如，要求保留 1 位小数的时候，我就拼接出来 “%.1lf” 字符串信息要求保留 2 位小数的时候就拼接处理出 “%.2lf”字符串信息即可。

```c
#include <stdio.h>
#include <string.h>
int main()
{
  double num;
  int n;
  char str[100];
  scanf("%lf%d", &num, &n);
  sprintf(str, "%%.%dlf\n", n);
  printf(str, num);
  return 0;
}
```

 程序主函数的第 3～5 行，分别定义了一个浮点型变量 num，一个整型变量 n 和 一个字符数组 str。接下来我们就要依据 n 的信息，利用 sprintf 函数把构造出来的格式控制字符串信息输出到 str 字符数组中。 

 这里需要注意的是第 7 行的两个百分号 （%%），它代表输出的时候，输出一个百分号，这是为了与格式占位符的 % 相兼容。试想一下，如果不这样规定，当你格式控制字符串是 “%d” 的时候，就会出现歧义，一方面可以解释成为是输出一个 % 和一个 d 字符，另一方面可以代表十进制整型的格式占位符。 

最后我们把字符数组 str 当成原来的格式控制字符串传给 printf 函数，这样，就将文章开始时，代码中的 printf 函数的第一个参数，从定值字符串信息，替换成了变量字符数组 str 中所存储的信息。通过今天这个任务，你应该可以看到，拥有变量的程序，会使得我们的程序更具一般性和通用性。

 其实变量代表了问题中可以被抽象化出来的量，就像以前，我们刻板的认为 printf 的第一个参数只能是一个显示的字符串信息，通过今天的学习，我们才彻底明白，printf 第一个参数，无非就是需要一个字符串的值，所以我们不仅仅可以传递给 printf 函数一个字符串的值，更可以传递给它一个字符数组，这样会使得整个程序功能更加灵活。 

#### 5.课程小结

 通过今天对于字符串内容的学习，我们更加明确了“值”和“变量”的概念，这个概念，在后面学习指针相关知识的时候是非常重要的，所以你可千万不要忽视了今天我们花大量篇幅解释的这两个看似显然的概念。记住“值”和“变量”是两个概念，“变量”是存储“值”的地方。 

1.  字符串信息可以存储在字符数组中，字符数组就是“变量”的概念，字符串就是“值”的概念 
2.  sscanf 和 sprintf 函数，本质上在做的是以字符串为中间值，做各种数据类型之间的转换。 